<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ROBOSTREAKS CLUB</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
            mono: ['Fira Code', 'Courier New', 'monospace'],
          },
          animation: {
            'fade-in': 'fadeIn 0.6s ease-out forwards',
            'slide-up': 'slideUp 0.5s ease-out forwards',
            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' },
            },
            slideUp: {
                '0%': { opacity: '0', transform: 'translateY(10px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
            }
          }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f8fafc; /* bg-slate-50 */
      color: #334155; /* text-slate-700 */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .accent-blue-600 {
      accent-color: #2563eb;
    }
    .stat-icon-wrapper {
        width: 3rem;
        height: 3rem;
        border-radius: 9999px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }
    .stat-icon-wrapper > svg {
        width: 1.5rem;
        height: 1.5rem;
    }
  </style>
<script type="importmap">
{
  "imports": {
    "rxjs": "https://aistudiocdn.com/rxjs@^7.8.2?conditions=es2015",
    "rxjs/operators": "https://aistudiocdn.com/rxjs@^7.8.2/operators?conditions=es2015",
    "rxjs/ajax": "https://aistudiocdn.com/rxjs@^7.8.2/ajax?conditions=es2015",
    "rxjs/webSocket": "https://aistudiocdn.com/rxjs@^7.8.2/webSocket?conditions=es2015",
    "rxjs/testing": "https://aistudiocdn.com/rxjs@^7.8.2/testing?conditions=es2015",
    "rxjs/fetch": "https://aistudiocdn.com/rxjs@^7.8.2/fetch?conditions=es2015",
    "@angular/compiler": "https://next.esm.sh/@angular/compiler@^21.0.1?external=rxjs",
    "@angular/platform-browser": "https://next.esm.sh/@angular/platform-browser@^21.0.1?external=rxjs",
    "@angular/core": "https://next.esm.sh/@angular/core@^21.0.1?external=rxjs",
    "@google/genai": "https://next.esm.sh/@google/genai@^1.30.0?external=rxjs",
    "@angular/common": "https://next.esm.sh/@angular/common@^21.0.1?external=rxjs"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body class="antialiased">
  <div id="app-root"></div>

  <script type="module">
    // --- ICONS (SVG Strings) ---
    const Icons = {
        User: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>`,
        Key: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="7.5" cy="15.5" r="5.5"/><path d="m21 2-9.6 9.6"/><path d="m15.5 7.5 3 3L22 7l-3-3"/></svg>`,
        Terminal: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"/><line x1="12" x2="20" y1="19" y2="19"/></svg>`,
        LogOut: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>`,
        Hash: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="9" y2="9"/><line x1="4" x2="20" y1="15" y2="15"/><line x1="10" x2="8" y1="3" y2="21"/><line x1="16" x2="14" y1="3" y2="21"/></svg>`,
        Mail: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>`,
        Phone: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>`,
        CheckCircle2: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>`,
        AlertCircle: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>`,
        Users: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>`,
        AlertTriangle: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>`,
        Search: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>`,
        MoreVertical: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>`,
        X: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>`,
        Sparkles: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275Z"/></svg>`,
        Send: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>`,
        Check: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>`,
        ArrowRight: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>`,
        Delete: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>`
    };
    
    // --- DATA ---
    let mockMembers = [
        { id: '1', name: 'Alice Johnson', email: 'alice@university.edu', password: 'password123', mobile: '+1 (555) 123-4567', branch: 'Computer Science', registrationNo: 'CS2024001', joinDate: '2023-09-01', role: 'MEMBER' },
        { id: '2', name: 'Bob Smith', email: 'bob@university.edu', password: 'password123', mobile: '+1 (555) 987-6543', branch: 'Mech. Eng.', registrationNo: 'ME2024045', joinDate: '2023-09-15', role: 'MEMBER' },
        { id: '3', name: 'Charlie Davis', email: 'charlie@university.edu', password: 'password123', mobile: '+1 (555) 456-7890', branch: 'Electronics', registrationNo: 'EC2024102', joinDate: '2024-01-10', role: 'MEMBER' },
        { id: '4', name: 'Dana Lee', email: 'dana@university.edu', password: 'password123', mobile: '+1 (555) 222-3333', branch: 'Data Science', registrationNo: 'DS2024088', joinDate: '2023-11-20', role: 'MEMBER' },
        { id: '5', name: 'Ethan Hunt', email: 'ethan@university.edu', password: 'password123', mobile: '+1 (555) 555-5555', branch: 'Computer Science', registrationNo: 'CS2024015', joinDate: '2023-10-05', role: 'MEMBER' },
        { id: '6', name: 'Fiona Glenanne', email: 'fiona@university.edu', password: 'password123', mobile: '+1 (555) 666-6666', branch: 'Civil Eng.', registrationNo: 'CE2024032', joinDate: '2024-02-20', role: 'MEMBER' },
    ];

    const mockAnnouncements = [
        { id: '101', title: 'HACKATHON_2024', content: 'Protocol initiated for Annual Hackathon. Teams of 4 required. Execute registration.', date: '2024-05-20', type: 'EVENT' },
        { id: '102', title: 'SYS_MAINTENANCE', content: 'Server downtime scheduled [0200-0400]. Backup local data immediately.', date: '2024-05-18', type: 'URGENT' },
        { id: '103', title: 'AI_ETHICS_WORKSHOP', content: 'Guest lecture: "The Ghost in the Machine". Attendance optional but recommended.', date: '2024-05-15', type: 'GENERAL' }
    ];

    const mockAdmin = { email: 'admin@nexus.com', password: 'admin' };

    // --- STATE ---
    const state = {
        view: 'BOOT', // BOOT, LOGIN, DASHBOARD
        user: null,
        login: { tab: 'MEMBER', error: '', loading: false, email: '', password: '' },
        admin: {
            searchQuery: '',
            selectedIds: new Set(),
            openDropdownId: null
        }
    };
    
    const appRoot = document.getElementById('app-root');
    
    // --- RENDER FUNCTIONS ---
    function render() {
        if (state.view === 'BOOT') {
            appRoot.innerHTML = renderBoot();
            runBootSequence();
        } else if (state.view === 'LOGIN') {
            appRoot.innerHTML = renderLogin();
            attachLoginListeners();
        } else if (state.view === 'DASHBOARD') {
            appRoot.innerHTML = renderLayout(state.user);
            attachLayoutListeners();
            
            const mainContent = document.getElementById('main-content');
            if(state.user.role === 'ADMIN') {
                mainContent.innerHTML = renderAdminView();
                attachAdminListeners();
            } else {
                mainContent.innerHTML = renderMemberView(state.user);
            }
        }
    }

    // --- BOOT SEQUENCE ---
    function renderBoot() {
        return `
        <div id="boot-container" class="fixed inset-0 bg-slate-900 z-50 flex items-center justify-center font-mono text-blue-400 text-sm">
            <div class="w-96 animate-fade-in">
                <div id="boot-text" class="mb-4 h-40 overflow-hidden flex flex-col justify-end"></div>
                <div class="w-full h-1.5 bg-slate-700 rounded-full overflow-hidden">
                    <div id="boot-progress" class="h-full bg-blue-500 transition-all duration-[2000ms] ease-out w-0"></div>
                </div>
            </div>
        </div>`;
    }

    function runBootSequence() {
        const lines = [
            "Initializing ROBOSTREAKS...",
            "Loading Core Modules...",
            "Verifying Protocols...",
            "Establishing Secure Link...",
            "Welcome, User."
        ];
        const textEl = document.getElementById('boot-text');
        const progressEl = document.getElementById('boot-progress');

        setTimeout(() => { if (progressEl) progressEl.style.width = '100%'; }, 100);

        let i = 0;
        const interval = setInterval(() => {
            if (i < lines.length) {
                const div = document.createElement('div');
                div.className = 'animate-fade-in whitespace-nowrap';
                div.textContent = `> ${lines[i]}`;
                textEl.appendChild(div);
                i++;
            } else {
                clearInterval(interval);
                setTimeout(() => {
                    state.view = 'LOGIN';
                    render();
                }, 800);
            }
        }, 500);
    }
    
    // --- LOGIN ---
    function renderLogin() {
        return `
        <div class="min-h-screen flex items-center justify-center p-4 bg-slate-50 relative overflow-hidden">
            <div class="absolute inset-0 z-0 opacity-40">
                <div class="absolute top-1/4 left-1/4 w-[500px] h-[500px] bg-blue-200 rounded-full blur-3xl animate-pulse-slow"></div>
                <div class="absolute bottom-1/4 right-1/4 w-[400px] h-[400px] bg-indigo-200 rounded-full blur-3xl animate-pulse-slow" style="animation-delay: 1s"></div>
            </div>

            <div class="w-full max-w-md relative z-10 animate-slide-up">
                <div class="bg-white/80 backdrop-blur-xl border border-gray-200 shadow-xl rounded-lg">
                    <div class="p-8 sm:p-10">
                        <div class="mb-10 text-center">
                            <div class="w-14 h-14 mx-auto bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center text-white mb-4 shadow-lg shadow-blue-500/20">
                                <div class="w-7 h-7">${Icons.User}</div>
                            </div>
                            <h1 class="text-2xl font-bold text-slate-800 tracking-tight">ROBOSTREAKS</h1>
                            <p class="text-xs text-slate-500 font-mono tracking-widest uppercase mt-1">Club Portal</p>
                        </div>

                        <div class="grid grid-cols-2 p-1 bg-slate-100 rounded-lg mb-8 border border-slate-200">
                            <button id="tab-member" class="py-2.5 text-xs font-bold uppercase tracking-wider transition-all rounded-md ${state.login.tab === 'MEMBER' ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500 hover:bg-slate-200/50'}">Member</button>
                            <button id="tab-admin" class="py-2.5 text-xs font-bold uppercase tracking-wider transition-all rounded-md ${state.login.tab === 'ADMIN' ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500 hover:bg-slate-200/50'}">Admin</button>
                        </div>

                        <form id="login-form" class="space-y-5">
                            <div class="space-y-1.5">
                                <label class="text-xs font-medium text-slate-600 ml-1">Email Address</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none text-slate-400">
                                        <div class="w-4 h-4">${Icons.User}</div>
                                    </div>
                                    <input type="text" id="email" required value="${state.login.email}"
                                        class="block w-full pl-10 pr-3 py-2.5 bg-white border border-slate-300 text-slate-800 text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all rounded-md"
                                        placeholder="${state.login.tab === 'MEMBER' ? 'member@university.edu' : 'admin@nexus.com'}" />
                                </div>
                            </div>
                            <div class="space-y-1.5">
                                <label class="text-xs font-medium text-slate-600 ml-1">Password</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none text-slate-400">
                                        <div class="w-4 h-4">${Icons.Key}</div>
                                    </div>
                                    <input type="password" id="password" required value="${state.login.password}"
                                        class="block w-full pl-10 pr-3 py-2.5 bg-white border border-slate-300 text-slate-800 text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all rounded-md"
                                        placeholder="••••••••" />
                                </div>
                            </div>

                            ${state.login.error ? `
                            <div class="p-3 bg-red-50 border border-red-200 text-red-700 text-xs font-medium flex items-center gap-2 rounded-md animate-fade-in">
                                <span class="w-1.5 h-1.5 bg-red-500 rounded-full"></span> ${state.login.error}
                            </div>
                            ` : ''}

                            <button type="submit" ${state.login.loading ? 'disabled' : ''} class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-md transition-all duration-200 flex items-center justify-center gap-2 group disabled:opacity-60 disabled:cursor-not-allowed shadow-lg shadow-blue-500/20 hover:shadow-xl hover:shadow-blue-500/30">
                                ${state.login.loading ? '<span>AUTHENTICATING...</span>' : `
                                <span>Secure Login</span>
                                <div class="w-4 h-4 group-hover:translate-x-1 transition-transform">${Icons.ArrowRight}</div>
                                `}
                            </button>
                        </form>

                        <div class="mt-8 text-center text-xs text-slate-500">
                            Use <span id="fill-member" class="text-blue-600 font-semibold cursor-pointer hover:underline">Demo Member</span> or <span id="fill-admin" class="text-blue-600 font-semibold cursor-pointer hover:underline">Demo Admin</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>`;
    }

    function attachLoginListeners() {
        document.getElementById('tab-member').onclick = () => { state.login.tab = 'MEMBER'; state.login.error = ''; state.login.email = ''; state.login.password = ''; render(); };
        document.getElementById('tab-admin').onclick = () => { state.login.tab = 'ADMIN'; state.login.error = ''; state.login.email = ''; state.login.password = ''; render(); };
        
        document.getElementById('email').oninput = (e) => { state.login.email = e.target.value; };
        document.getElementById('password').oninput = (e) => { state.login.password = e.target.value; };

        document.getElementById('fill-member').onclick = () => {
            state.login.tab = 'MEMBER';
            state.login.email = 'alice@university.edu';
            state.login.password = 'password123';
            render();
        };
        document.getElementById('fill-admin').onclick = () => {
            state.login.tab = 'ADMIN';
            state.login.email = 'admin@nexus.com';
            state.login.password = 'admin';
            render();
        };

        document.getElementById('login-form').onsubmit = (e) => {
            e.preventDefault();
            state.login.loading = true;
            render();

            setTimeout(() => {
                let success = false;
                let foundUser = null;
                if (state.login.tab === 'ADMIN') {
                    if (state.login.email === mockAdmin.email && state.login.password === mockAdmin.password) {
                        success = true;
                        foundUser = { id: 'admin-001', name: 'System Admin', email: mockAdmin.email, registrationNo: 'ROOT', branch: 'CORE', role: 'ADMIN', mobile: '', joinDate: '' };
                    }
                } else {
                    const m = mockMembers.find(u => u.email === state.login.email && u.password === state.login.password);
                    if (m) {
                        success = true;
                        foundUser = m;
                    }
                }

                state.login.loading = false;
                if (success) {
                    state.user = foundUser;
                    state.view = 'DASHBOARD';
                } else {
                    state.login.error = 'Access Denied: Invalid Credentials.';
                }
                render();
            }, 1200);
        };
    }

    // --- DASHBOARD LAYOUT ---
    function renderLayout(user) {
        return `
        <div class="min-h-screen flex flex-col bg-slate-50 text-slate-700">
            <nav class="sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-slate-200">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 h-16 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center text-white shadow-md shadow-blue-500/20">
                            <div class="w-5 h-5">${Icons.Terminal}</div>
                        </div>
                        <div class="flex flex-col leading-tight">
                            <span class="text-slate-800 font-bold tracking-tight text-base">ROBOSTREAKS</span>
                            <span class="text-xs text-slate-500 mt-0.5">Welcome, ${user.name}</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-4 sm:gap-6">
                        <div class="hidden md:flex items-center">
                            <span class="text-[10px] text-emerald-600 font-mono tracking-wider flex items-center gap-1.5">
                                <span class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></span> ONLINE
                            </span>
                        </div>
                        <div class="h-8 w-px bg-slate-200 hidden md:block"></div>
                        <div class="flex items-center gap-3">
                            <span id="nav-clock" class="text-xs font-mono text-slate-500 bg-slate-100 px-2 py-1.5 rounded-md hidden sm:block">--:--</span>
                            <button id="logout-btn" class="group flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-medium text-slate-500 hover:text-slate-800 hover:bg-slate-100 transition-all border border-transparent hover:border-slate-200">
                                <div class="w-4 h-4 group-hover:text-red-500 transition-colors">${Icons.LogOut}</div>
                                <span class="hidden sm:inline">Sign Out</span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>

            <main id="main-content" class="flex-grow max-w-7xl w-full mx-auto p-4 sm:p-6 lg:p-8"></main>

            <footer class="border-t border-slate-200 bg-white mt-auto">
                <div class="max-w-7xl mx-auto px-6 py-6 flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-slate-500">
                    <div class="font-medium">&copy; 2025 Robostreaks Club. All rights reserved.</div>
                    <div class="flex gap-6 font-medium">
                        <a href="#" class="hover:text-blue-600 transition-colors">Privacy</a>
                        <a href="#" class="hover:text-blue-600 transition-colors">Terms</a>
                        <a href="#" class="hover:text-blue-600 transition-colors">Support</a>
                    </div>
                </div>
            </footer>
        </div>`;
    }

    function attachLayoutListeners() {
        document.getElementById('logout-btn').onclick = () => {
            state.user = null;
            state.view = 'LOGIN';
            state.login.email = '';
            state.login.password = '';
            state.admin.selectedIds.clear();
            render();
        };
        
        const clockEl = document.getElementById('nav-clock');
        const tick = () => {
            if (clockEl) clockEl.innerText = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        tick();
        setInterval(tick, 30000); // Update every 30 seconds is enough
    }
    
    // --- MEMBER VIEW ---
    function renderMemberView(user) {
        const hour = new Date().getHours();
        const greeting = hour < 12 ? "Good Morning" : hour < 18 ? "Good Afternoon" : "Good Evening";
        const firstName = user.name.split(' ')[0];
        const initials = user.name.split(' ').map(n => n[0]).slice(0, 2).join('').toUpperCase();
        
        function getAvatarColorClass(name) {
            const colors = ['bg-blue-500', 'bg-emerald-500', 'bg-amber-500', 'bg-indigo-500', 'bg-rose-500', 'bg-cyan-500'];
            if (!name) return colors[0];
            let hash = 0;
            for (let i = 0; i < name.length; i++) {
                const char = name.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash |= 0;
            }
            return colors[Math.abs(hash % colors.length)];
        }

        const announcementTypeClasses = {
            'URGENT': 'border-l-red-500',
            'EVENT': 'border-l-purple-500',
            'GENERAL': 'border-l-blue-500'
        };
        
        const announcementIcon = (type) => {
            if(type === 'URGENT') return `<div class="w-5 h-5 text-red-500">${Icons.AlertTriangle}</div>`;
            if(type === 'EVENT') return `<div class="w-5 h-5 text-purple-500">${Icons.Sparkles}</div>`;
            return `<div class="w-5 h-5 text-blue-500">${Icons.AlertCircle}</div>`;
        }

        return `
        <div class="space-y-8 animate-fade-in">
            <div>
                <h1 class="text-3xl font-bold text-slate-800 mb-1 tracking-tight">${greeting}, ${firstName}</h1>
                <p class="text-slate-500">Here's your latest club summary and announcements.</p>
            </div>

            <!-- Member Identity Card -->
            <div class="bg-white border border-slate-200 rounded-xl shadow-sm p-6 flex flex-col sm:flex-row items-center gap-6 transition-all hover:shadow-lg hover:border-blue-300/50">
                <div class="w-24 h-24 rounded-full flex items-center justify-center text-white text-4xl font-bold shrink-0 shadow-inner ${getAvatarColorClass(user.name)}">
                    <span>${initials}</span>
                </div>
                
                <div class="flex-grow text-center sm:text-left">
                    <h2 class="text-2xl font-bold text-slate-800">${user.name}</h2>
                    <p class="text-sm font-semibold text-blue-600">${user.branch}</p>
                    <p class="text-xs text-slate-500 font-mono mt-1">Reg No: ${user.registrationNo}</p>
                </div>

                <div class="w-full sm:w-auto border-t sm:border-t-0 sm:border-l border-slate-200/80 pt-4 sm:pt-0 sm:pl-6 space-y-3 text-sm">
                    <div class="flex items-center gap-3">
                        <div class="w-4 h-4 text-slate-400">${Icons.Mail}</div>
                        <span class="font-medium text-slate-600">${user.email}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-4 h-4 text-slate-400">${Icons.Phone}</div>
                        <span class="font-medium text-slate-600">${user.mobile}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-4 h-4 text-slate-400">${Icons.CheckCircle2}</div>
                        <span class="font-medium text-slate-600">Joined: ${user.joinDate}</span>
                    </div>
                </div>
            </div>

            <!-- System Broadcasts -->
            <div>
                <h3 class="text-lg font-bold text-slate-800 mb-4">System Broadcasts</h3>
                <div class="space-y-4">
                    ${mockAnnouncements.map(item => `
                    <div class="bg-white border border-slate-200 rounded-lg p-4 flex items-start gap-4 transition-all hover:shadow-md hover:border-slate-300 border-l-4 ${announcementTypeClasses[item.type]}">
                        <div class="flex-shrink-0 pt-1">${announcementIcon(item.type)}</div>
                        <div class="flex-grow">
                            <div class="flex justify-between items-baseline">
                                <h4 class="text-md font-bold text-slate-800">${item.title}</h4>
                                <span class="text-xs font-medium text-slate-500">${item.date}</span>
                            </div>
                            <p class="text-sm text-slate-600 leading-relaxed mt-1">${item.content}</p>
                        </div>
                    </div>
                    `).join('')}
                </div>
            </div>
        </div>`;
    }
    
    // --- ADMIN VIEW ---
    function renderAdminView() {
        const query = state.admin.searchQuery.toLowerCase();
        const filteredMembers = mockMembers.filter(m => 
            !query ||
            m.name.toLowerCase().includes(query) ||
            m.email.toLowerCase().includes(query) ||
            m.registrationNo.toLowerCase().includes(query) ||
            m.branch.toLowerCase().includes(query)
        );
        const areAllFilteredSelected = filteredMembers.length > 0 && filteredMembers.every(m => state.admin.selectedIds.has(m.id));
        
        const selectedEmails = mockMembers
            .filter(m => state.admin.selectedIds.has(m.id))
            .map(m => m.email)
            .join(',');
        const mailtoHref = selectedEmails ? `mailto:${selectedEmails}` : '';

        function getInitials(name) {
            return name.split(' ').map(n => n[0]).slice(0, 2).join('').toUpperCase();
        }

        function getColorClass(name) {
            const colors = ['bg-blue-500', 'bg-emerald-500', 'bg-amber-500', 'bg-indigo-500', 'bg-rose-500', 'bg-cyan-500'];
            if (!name) return colors[0];
            let hash = 0;
            for (let i = 0; i < name.length; i++) {
                hash = ((hash << 5) - hash) + name.charCodeAt(i);
                hash |= 0;
            }
            return colors[Math.abs(hash % colors.length)];
        }

        return `
        <div class="animate-fade-in">
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-slate-900 tracking-tight">Admin Dashboard</h1>
                <p class="mt-1 text-slate-500">Oversee members, monitor activity, and manage communications.</p>
            </div>

            <!-- Stats Panel -->
            <div class="mb-8 bg-white border border-slate-200 rounded-xl shadow-sm p-5 flex items-center gap-4">
                <div class="stat-icon-wrapper bg-blue-100 text-blue-600">${Icons.Users}</div>
                <div>
                    <p class="text-sm font-medium text-slate-500">Total Members</p>
                    <p class="text-2xl font-bold text-slate-800">${mockMembers.length}</p>
                </div>
            </div>

            <div class="flex flex-col flex-grow bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden">
                <div class="p-4 sm:p-5 border-b border-slate-200">
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
                        <div>
                            <h2 class="text-lg font-semibold text-slate-800">Member Management</h2>
                            <p class="text-sm text-slate-500 mt-1">Search, select, and manage club members.</p>
                        </div>
                        <div class="relative w-full sm:w-64">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">${Icons.Search}</div>
                            <input type="text" id="admin-search" value="${state.admin.searchQuery}" placeholder="Search members..." class="block w-full pl-10 pr-3 py-2 border border-slate-300 rounded-md bg-white text-slate-800 placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 sm:text-sm transition-all">
                        </div>
                    </div>
                </div>

                ${state.admin.selectedIds.size > 0 ? `
                <div class="px-5 py-3 bg-blue-50 border-y border-blue-200 flex justify-between items-center animate-fade-in">
                    <span class="text-sm font-semibold text-blue-800">${state.admin.selectedIds.size} member(s) selected</span>
                    <a href="${mailtoHref}" class="flex items-center gap-2 py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-xs rounded-md transition-all shadow-sm hover:shadow-md">
                        <div class="w-4 h-4">${Icons.Mail}</div><span>Email Selected</span>
                    </a>
                </div>
                ` : ''}

                <div class="flex-grow overflow-auto relative">
                    <table class="w-full text-left">
                        <thead class="bg-slate-50 text-xs uppercase text-slate-500 font-semibold tracking-wider sticky top-0 z-10 border-b border-slate-200">
                            <tr>
                                <th class="px-6 py-3 w-12"><input type="checkbox" id="select-all-checkbox" ${areAllFilteredSelected ? 'checked' : ''} class="accent-blue-600 cursor-pointer w-4 h-4 rounded border-slate-300"></th>
                                <th class="px-6 py-3">Member</th>
                                <th class="px-6 py-3 hidden md:table-cell">Details</th>
                                <th class="px-6 py-3 text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200 bg-white">
                            ${filteredMembers.map(member => `
                            <tr class="group transition-colors ${state.admin.selectedIds.has(member.id) ? 'bg-blue-50' : 'hover:bg-slate-50'}">
                                <td class="px-6 py-3 text-center"><input type="checkbox" class="select-one-checkbox" data-id="${member.id}" ${state.admin.selectedIds.has(member.id) ? 'checked' : ''} class="accent-blue-600 cursor-pointer w-4 h-4 rounded border-slate-300"></td>
                                <td class="px-6 py-4">
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 rounded-full flex items-center justify-center shrink-0 text-white font-bold text-sm ${getColorClass(member.name)}">
                                            <span>${getInitials(member.name)}</span>
                                        </div>
                                        <div>
                                            <div class="text-sm font-semibold text-slate-800 group-hover:text-blue-600">${member.name}</div>
                                            <div class="text-xs text-slate-500">${member.email}</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 hidden md:table-cell">
                                    <div class="text-sm font-medium text-slate-700">${member.branch}</div>
                                    <div class="text-xs text-slate-500 font-mono">${member.registrationNo}</div>
                                </td>
                                <td class="px-6 py-4 text-right relative">
                                    <div class="flex items-center justify-end gap-1">
                                        <a href="mailto:${member.email}" class="text-slate-500 hover:text-blue-600 p-2 rounded-md hover:bg-blue-100 transition-all" title="Email ${member.name}">${Icons.Mail}</a>
                                        <button class="dropdown-toggle" data-id="${member.id}" class="text-slate-500 hover:text-slate-800 p-2 rounded-md hover:bg-slate-200 transition-all" title="More options">${Icons.MoreVertical}</button>
                                    </div>
                                    ${state.admin.openDropdownId === member.id ? `
                                    <div class="absolute right-8 top-full mt-1 w-40 bg-white rounded-md shadow-lg border border-slate-200 z-20 animate-fade-in origin-top-right">
                                        <div class="py-1">
                                            <button class="delete-member-btn flex items-center gap-2 w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 hover:text-red-700" data-id="${member.id}" data-name="${member.name}">
                                                ${Icons.Delete}
                                                <span>Delete Member</span>
                                            </button>
                                        </div>
                                    </div>
                                    ` : ''}
                                </td>
                            </tr>
                            `).join('')}
                            ${filteredMembers.length === 0 ? `<tr><td colspan="4" class="py-20 text-center text-slate-500 text-sm">No members found matching your search.</td></tr>` : ''}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>`;
    }
    
    function attachAdminListeners() {
        document.getElementById('admin-search').oninput = (e) => {
            state.admin.searchQuery = e.target.value;
            state.admin.openDropdownId = null;
            render();
        };

        document.getElementById('select-all-checkbox').onchange = (e) => {
            const query = state.admin.searchQuery.toLowerCase();
            const filteredIds = mockMembers
                .filter(m => !query || m.name.toLowerCase().includes(query) || m.email.toLowerCase().includes(query))
                .map(m => m.id);
            
            const newIds = new Set(state.admin.selectedIds);
            if (e.target.checked) {
                filteredIds.forEach(id => newIds.add(id));
            } else {
                filteredIds.forEach(id => newIds.delete(id));
            }
            state.admin.selectedIds = newIds;
            render();
        };

        document.querySelectorAll('.select-one-checkbox').forEach(el => {
            el.onchange = (e) => {
                const id = e.target.dataset.id;
                const newIds = new Set(state.admin.selectedIds);
                if (e.target.checked) {
                    newIds.add(id);
                } else {
                    newIds.delete(id);
                }
                state.admin.selectedIds = newIds;
                render();
            };
        });
        
        document.querySelectorAll('.dropdown-toggle').forEach(el => {
            el.onclick = (e) => {
                const id = e.currentTarget.dataset.id;
                state.admin.openDropdownId = state.admin.openDropdownId === id ? null : id;
                render();
            }
        });

        document.querySelectorAll('.delete-member-btn').forEach(el => {
            el.onclick = (e) => {
                const id = e.currentTarget.dataset.id;
                const name = e.currentTarget.dataset.name;
                state.admin.openDropdownId = null;
                if (window.confirm(`Are you sure you want to delete ${name}? This action cannot be undone.`)) {
                    mockMembers = mockMembers.filter(m => m.id !== id);
                }
                render();
            }
        });
    }

    // --- INITIAL RENDER ---
    render();

  </script>
</body>
</html>
